import random

# список учеников
students = ['Аполлон', 'Ярослав', 'Александра', 'Дарья', 'Ангелина']
# отсортируем список учеников
students.sort()
# список предметов
classes = ['Математика', 'Русский язык', 'Информатика']
# пустой словарь с оценками по каждому ученику и предмету
students_marks = {}
# сгенерируем данные по оценкам:
# цикл по ученикам
for student in students:
    students_marks[student] = {}
    # цикл по предметам
    for class_ in classes:
        marks = [random.randint(1, 5) for i in range(3)]
        students_marks[student][class_] = marks


def print_commands():
    print('''
    Список команд:
    1. Добавить оценки ученика по предмету
    2. Вывести средний балл по всем предметам по каждому ученику
    3. Вывести все оценки по всем ученикам
    4. Вывести все оценки определенного ученика
    5. Вывести средний балл по каждому предмету для определенного ученика
    6. Удалить оценку ученика по предмету
    7. Редактировать оценку ученика по предмету
    8. Добавить нового ученика
    9. Удалить ученика
    10. Добавить новый предмет
    11. Удалить предмет
    12. Вывести список всех учеников
    13. Вывести список всех предметов
    14. Выход из программы
    ''')


def print_all_marks():
    """Вывод всех оценок всех учеников"""
    print('Все оценки по всем ученикам:')
    for student in students:
        print(f'{student}:')
        for class_ in classes:
            print(f'\t{class_} - {students_marks[student][class_]}')
        print()


def print_student_marks(student_name):
    """Вывод всех оценок определенного ученика"""
    if student_name in students_marks:
        print(f'Все оценки ученика {student_name}:')
        for class_ in classes:
            print(f'{class_} - {students_marks[student_name][class_]}')
    else:
        print('ОШИБКА: Ученик не найден')


def print_student_average(student_name):
    """Вывод среднего балла по каждому предмету для определенного ученика"""
    if student_name in students_marks:
        print(f'Средний балл ученика {student_name}:')
        for class_ in classes:
            marks = students_marks[student_name][class_]
            average = sum(marks) / len(marks) if marks else 0
            print(f'{class_} - {average:.2f}')
    else:
        print('ОШИБКА: Ученик не найден')


def delete_mark(student_name, class_name, mark_index):
    """Удаление оценки ученика по предмету"""
    if (student_name in students_marks and
            class_name in students_marks[student_name] and
            mark_index < len(students_marks[student_name][class_name])):

        deleted_mark = students_marks[student_name][class_name].pop(mark_index)
        print(f'Удалена оценка {deleted_mark} по предмету {class_name} для ученика {student_name}')
    else:
        print('ОШИБКА: Неверные данные')


def edit_mark(student_name, class_name, mark_index, new_mark):
    """Редактирование оценки ученика по предмету"""
    if (student_name in students_marks and
            class_name in students_marks[student_name] and
            mark_index < len(students_marks[student_name][class_name])):

        old_mark = students_marks[student_name][class_name][mark_index]
        students_marks[student_name][class_name][mark_index] = new_mark
        print(f'Оценка {old_mark} изменена на {new_mark} по предмету {class_name} для ученика {student_name}')
    else:
        print('ОШИБКА: Неверные данные')


def add_student(student_name):
    """Добавление нового ученика"""
    if student_name not in students:
        students.append(student_name)
        students.sort()
        students_marks[student_name] = {}
        for class_ in classes:
            students_marks[student_name][class_] = []
        print(f'Добавлен новый ученик: {student_name}')
    else:
        print('ОШИБКА: Ученик уже существует')


def delete_student(student_name):
    """Удаление ученика"""
    if student_name in students:
        students.remove(student_name)
        del students_marks[student_name]
        print(f'Ученик {student_name} удален')
    else:
        print('ОШИБКА: Ученик не найден')


def add_class(class_name):
    """Добавление нового предмета"""
    if class_name not in classes:
        classes.append(class_name)
        for student in students:
            students_marks[student][class_name] = []
        print(f'Добавлен новый предмет: {class_name}')
    else:
        print('ОШИБКА: Предмет уже существует')


def delete_class(class_name):
    """Удаление предмета"""
    if class_name in classes:
        classes.remove(class_name)
        for student in students:
            if class_name in students_marks[student]:
                del students_marks[student][class_name]
        print(f'Предмет {class_name} удален')
    else:
        print('ОШИБКА: Предмет не найден')


# Основной цикл программы
print_commands()

while True:
    try:
        command = int(input('\nВведите команду: '))

        if command == 1:
            print('1. Добавить оценку ученика по предмету')
            student = input('Введите имя ученика: ')
            class_ = input('Введите предмет: ')
            mark = int(input('Введите оценку: '))

            if student in students_marks and class_ in students_marks[student]:
                students_marks[student][class_].append(mark)
                print(f'Для {student} по предмету {class_} добавлена оценка {mark}')
            else:
                print('ОШИБКА: неверное имя ученика или название предмета')

        elif command == 2:
            print('2. Средний балл по всем предметам по каждому ученику')
            for student in students:
                print(f'\n{student}:')
                for class_ in classes:
                    marks = students_marks[student][class_]
                    average = sum(marks) / len(marks) if marks else 0
                    print(f'{class_} - {average:.2f}')

        elif command == 3:
            print_all_marks()

        elif command == 4:
            print('4. Все оценки определенного ученика')
            student = input('Введите имя ученика: ')
            print_student_marks(student)

        elif command == 5:
            print('5. Средний балл по каждому предмету для определенного ученика')
            student = input('Введите имя ученика: ')
            print_student_average(student)

        elif command == 6:
            print('6. Удалить оценку ученика по предмету')
            student = input('Введите имя ученика: ')
            class_ = input('Введите предмет: ')

            if student in students_marks and class_ in students_marks[student]:
                marks = students_marks[student][class_]
                print(f'Оценки по предмету {class_}: {marks}')
                if marks:
                    mark_index = int(input('Введите индекс оценки для удаления (начиная с 0): '))
                    delete_mark(student, class_, mark_index)
                else:
                    print('Нет оценок для удаления')
            else:
                print('ОШИБКА: неверное имя ученика или название предмета')

        elif command == 7:
            print('7. Редактировать оценку ученика по предмету')
            student = input('Введите имя ученика: ')
            class_ = input('Введите предмет: ')

            if student in students_marks and class_ in students_marks[student]:
                marks = students_marks[student][class_]
                print(f'Оценки по предмету {class_}: {marks}')
                if marks:
                    mark_index = int(input('Введите индекс оценки для редактирования (начиная с 0): '))
                    new_mark = int(input('Введите новую оценку: '))
                    edit_mark(student, class_, mark_index, new_mark)
                else:
                    print('Нет оценок для редактирования')
            else:
                print('ОШИБКА: неверное имя ученика или название предмета')

        elif command == 8:
            print('8. Добавить нового ученика')
            student = input('Введите имя нового ученика: ')
            add_student(student)

        elif command == 9:
            print('9. Удалить ученика')
            student = input('Введите имя ученика для удаления: ')
            delete_student(student)

        elif command == 10:
            print('10. Добавить новый предмет')
            class_ = input('Введите название нового предмета: ')
            add_class(class_)

        elif command == 11:
            print('11. Удалить предмет')
            class_ = input('Введите название предмета для удаления: ')
            delete_class(class_)

        elif command == 12:
            print('12. Список всех учеников:')
            for i, student in enumerate(students, 1):
                print(f'{i}. {student}')

        elif command == 13:
            print('13. Список всех предметов:')
            for i, class_ in enumerate(classes, 1):
                print(f'{i}. {class_}')

        elif command == 14:
            print('14. Выход из программы')
            break

        else:
            print('ОШИБКА: Неизвестная команда')

    except ValueError:
        print('ОШИБКА: Введите число команды')
    except Exception as e:
        print(f'ОШИБКА: {e}')
